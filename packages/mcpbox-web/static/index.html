<!doctype html><html><head><meta charset="utf-8"/><title>MCPBox Web</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b1020;color:#e8ecff;margin:0}header{padding:16px 20px;border-bottom:1px solid #1b2440;background:#0f1730}h1{font-size:18px;margin:0}main{padding:20px;display:grid;gap:16px;grid-template-columns:1fr 1fr}.card{background:#111936;border:1px solid #1f2a4d;border-radius:14px;padding:14px}pre{background:#0b132b;border:1px solid #1e2a4a;border-radius:8px;color:#d7e0ff;padding:8px;white-space:pre-wrap;max-height:320px;overflow:auto}input{padding:8px;border-radius:8px;border:1px solid #1e2a4a;background:#0b132b;color:#d7e0ff}button{background:#4f7cff;color:#fff;border:0;border-radius:10px;padding:10px 14px;cursor:pointer}.row{display:flex;gap:12px;align-items:center}</style></head>
<body><header class="row"><h1>MCPBox Web</h1><span id="stat"></span></header>
<main><section class="card"><h3>Run xcode.validate</h3><div class="row"><input id="module" placeholder="module_path (default: examples/sample-repo)" style="flex:1"><input id="rules" placeholder="rules_path (default: packages/xcodebox-core/core/xcode.rules.yaml)" style="flex:1"><button id="run">Run</button></div><pre id="log"></pre></section><section class="card"><h3>Report</h3><button id="refresh">Refresh</button><pre id="report"></pre></section></main>
<script>
const stat=document.getElementById('stat'),log=document.getElementById('log'),rep=document.getElementById('report'),run=document.getElementById('run'),mod=document.getElementById('module'),rules=document.getElementById('rules'),refresh=document.getElementById('refresh');let ws;
function connect(){ws=new WebSocket((location.protocol==='https:'?'wss://':'ws://')+location.host+'/ws');ws.onopen=()=>stat.textContent='connected';ws.onclose=()=>stat.textContent='disconnected';ws.onmessage=(ev)=>{const m=JSON.parse(ev.data);if(m.method==='xcode.progress'){log.textContent+=m.params.chunk;log.scrollTop=log.scrollHeight;}else if(m.result){log.textContent+='\\n[done] code '+m.result.code+'\\n';}}}
connect();
run.onclick=()=>{log.textContent='';const p={method:'xcode.validate',params:{}};if(mod.value.trim())p.params.module_path=mod.value.trim();if(rules.value.trim())p.params.rules_path=rules.value.trim();ws.send(JSON.stringify(p));};
refresh.onclick=()=>{fetch('/report').then(r=>r.ok?r.text():Promise.resolve('No report')).then(t=>rep.textContent=t).catch(()=>rep.textContent='No report');};
</script></body></html>
